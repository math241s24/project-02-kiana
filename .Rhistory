library(knitr)
library(kableExtra)
library(transformr)
fires_sf <- readRDS('Data/fires_sf.rds')
ca_sf <- readRDS('Data/ca_sf.rds')
fires_manage <- readRDS('Data/fires_manage.rds')
fires_county <- readRDS('Data/fires_county.rds')
#map of management levels across california: federal, state, local, tribal etc
#ggplot() +
#  geom_sf(data = PAD_CA_sf, aes(fill = mang_level)) +
#  labs(fill = "Management Level") +
#  theme_void()
#map of county boundaries in CA
ggplot() +
geom_sf(data = ca_sf, aes(fill = NAME), show.legend = FALSE) +
labs(fill = "County") +
theme_void()
#map of fires in CA: colored by year
ggplot() +
geom_sf(data = fires_sf, aes(fill = factor(discover_yr))) +
labs(fill = "Year") +
scale_fill_manual(values = rainbow(length(unique(fires_sf$discover_yr)))) +
theme_void()
total_acres <- sum(PAD_CA$GIS_Acres, na.rm = TRUE)
PAD_CA <- read_csv("../Data/Original_Data/PAD_CA.csv",
col_types = cols(FeatClass = col_skip(),
Category = col_skip(),
Loc_Own = col_skip(),
Loc_Mang = col_skip(),
Own_Type = col_skip(),
Own_Name = col_skip(),
EHoldTyp = col_skip(),
EsmtHldr = col_skip(),
Comments = col_skip(),
Date_Est = col_skip(),
IUCNCtDt = col_skip(),
IUCN_Cat = col_skip(),
IUCNCtSrc = col_skip(),
Access_Src = col_skip(),
Access_Dt = col_skip(),
Loc_Ds = col_skip(),
Loc_Nm = col_skip(),
Src_Date = col_skip(),
Unit_Nm = col_skip(),
Pub_Access = col_skip(),
GAP_Sts = col_skip(),
GAPCdSrc = col_skip(),
GAPCdDt = col_skip()
))
PAD_CA <- PAD_CA %>%
rename(mang_level = Mang_Type,
mang_name = Mang_Name,
designation = Des_Tp
)
PAD_CA <- PAD_CA %>%
mutate(mang_level = case_when(
mang_level == "Regional Agency Special District" ~ "Local Government",
mang_level == "Joint" ~ "Local Government",
mang_level == "Private" ~ "Non-Governmental Organization",
mang_level == "Unknown" ~ "Non-Governmental Organization",
TRUE ~ mang_level
))
#making it spatial
PAD_CA_sf <- PAD_CA %>%
filter(!is.na(WKT)) %>%
st_as_sf(wkt = "WKT")
saveRDS(PAD_CA_sf, "PAD_CA_sf.rds")
PAD_CA_sf <- readRDS('Data/PAD_CA_sf.rds')
total_acres <- sum(PAD_CA_sf$GIS_Acres, na.rm = TRUE)
area_summary <- PAD_CA %>%
group_by(mang_level) %>%
summarise(total_area = sum(GIS_Acres),
percentage = (sum(GIS_Acres) / total_acres) * 100) %>%
arrange(desc(total_area))  # Optional: Arrange by total_area in descending order
print(area_summary)
#piechart visualization of management level
ggplot(area_summary, aes(x = "", y = percentage, fill = mang_level, label = paste0(round(percentage), "%"))) +
geom_bar(stat = "identity", width = 1) +
geom_text(position = position_stack(vjust = 0.5), aes(x = 1.55), color = "black", size = 3) +
coord_polar("y", start = 0) +
labs(title = "Public Lands Management:",
subtitle = "Percentage of Public Lands Each Jurisdiction Manages",
fill = "") +
theme_void() +
theme(legend.position = "bottom") +
scale_fill_brewer(palette = "Set2")
fire_counts_manglvl <- fires_manage %>%
group_by(mang_level) %>%
summarize(fire_count = n()) %>%
mutate(percentage = (fire_count / sum(fire_count)) * 100)
ggplot(fire_counts_manglvl, aes(x = "", y = percentage, fill = mang_level, label = paste0(round(percentage), "%"))) +
geom_bar(stat = "identity", width = 1) +
geom_text(position = position_stack(vjust = 0.5), aes(x = 1.55), color = "black", size = 3) +
coord_polar("y", start = 0) +
labs(title = "Wildfires on Public Lands:",
subtitle = "Percentage of fires by jurisdiction",
fill = "") +
theme_void() +
theme(legend.position = "bottom") +
scale_fill_brewer(palette = "Set2")
#74.3% of fires occurred on Federal Land, 510 fires
#17.4% of fires occurred on State Land, 120 fires
#nothing else of real importance
#and this is from 1984 - 2020 ...
fires_county_grp <- fires_county %>%
group_by(county_name, discover_yr) %>%
summarize(fire_count = n(), total_acres = sum(acres_total)) %>%
ungroup() %>%
group_by(discover_yr) %>%
mutate(total_fires = sum(fire_count),
total_acres_burnt = sum(total_acres),
numfires_perc = paste0(round((fire_count / total_fires) * 100), "%"),
acresfires_perc = paste0(round((total_acres / total_acres_burnt) * 100), "%"),
avg_size = total_acres / fire_count) %>%
ungroup()
ggplot(fire_counts_manglvl_yr, aes(x = discover_yr, y = fire_count, color = mang_level)) +
geom_line() +
labs(title = "CA Wildfires Over Time Across Land Management Level",
x = "Year Discovered",
y = "Number of Fires",
color = "Land Management")
View(fire_counts_manglvl)
fire_counts_manglvlyr <- fires_manage %>%
group_by(mang_level, discover_yr) %>%
summarize(fire_count = n()) %>%
mutate(percentage = (fire_count / sum(fire_count)) * 100)
ggplot(fire_counts_manglvlyr, aes(x = "", y = percentage, fill = mang_level, label = paste0(round(percentage), "%"))) +
geom_bar(stat = "identity", width = 1) +
geom_text(position = position_stack(vjust = 0.5), aes(x = 1.55), color = "black", size = 3) +
coord_polar("y", start = 0) +
labs(title = "Wildfires on Public Lands:",
subtitle = "Percentage of fires by jurisdiction",
fill = "") +
theme_void() +
theme(legend.position = "bottom") +
scale_fill_brewer(palette = "Set2")
fire_counts_manglvl <- fires_manage %>%
group_by(mang_level) %>%
summarize(fire_count = n()) %>%
mutate(percentage = (fire_count / sum(fire_count)) * 100)
ggplot(fire_counts_manglvl, aes(x = "", y = percentage, fill = mang_level, label = paste0(round(percentage), "%"))) +
geom_bar(stat = "identity", width = 1) +
geom_text(position = position_stack(vjust = 0.5), aes(x = 1.55), color = "black", size = 3) +
coord_polar("y", start = 0) +
labs(title = "Wildfires on Public Lands:",
subtitle = "Percentage of fires by jurisdiction",
fill = "") +
theme_void() +
theme(legend.position = "bottom") +
scale_fill_brewer(palette = "Set2")
View(fires_county_grp)
View(fires_manage)
fire_counts_manglvlyr <- fires_manage %>%
group_by(mang_level, discover_yr) %>%
summarize(fire_count = n(), total_acres = sum(total_reported_acres)) %>%
ungroup() %>%
group_by(discover_yr) %>%
mutate(total_fires = sum(fire_count),
total_acres_burnt = sum(total_acres),
numfires_perc = paste0(round((fire_count / total_fires) * 100), "%"),
acresfires_perc = paste0(round((total_acres / total_acres_burnt) * 100), "%"),
avg_size = total_acres / fire_count) %>%
ungroup()
ggplot(fire_counts_manglvlyr, aes(x = discover_yr, y = fire_count, color = mang_level)) +
geom_line() +
labs(title = "CA Wildfires Over Time Across Land Management Level",
x = "Year Discovered",
y = "Number of Fires",
color = "Land Management")
fire_counts_manglvl <- fires_manage %>%
group_by(mang_level) %>%
summarize(fire_count = n()) %>%
mutate(percentage = (fire_count / sum(fire_count)) * 100)
ggplot(fire_counts_manglvl, aes(x = "", y = percentage, fill = mang_level, label = paste0(round(percentage), "%"))) +
geom_bar(stat = "identity", width = 1) +
geom_text(position = position_stack(vjust = 0.5), aes(x = 1.55), color = "black", size = 3) +
coord_polar("y", start = 0) +
labs(title = "Wildfires on Public Lands:",
subtitle = "Percentage of fires by jurisdiction",
fill = "") +
theme_void() +
theme(legend.position = "bottom") +
scale_fill_brewer(palette = "Set2")
#74.3% of fires occurred on Federal Land, 510 fires
#17.4% of fires occurred on State Land, 120 fires
#nothing else of real importance
#and this is from 1984 - 2020 ...
fire_counts_manglvlyr <- fires_manage %>%
group_by(mang_level, discover_yr) %>%
summarize(fire_count = n(), total_acres = sum(total_reported_acres)) %>%
ungroup() %>%
group_by(discover_yr) %>%
mutate(total_fires = sum(fire_count),
total_acres_burnt = sum(total_acres),
numfires_perc = paste0(round((fire_count / total_fires) * 100), "%"),
acresfires_perc = paste0(round((total_acres / total_acres_burnt) * 100), "%"),
avg_size = total_acres / fire_count) %>%
ungroup()
ggplot(fire_counts_manglvlyr, aes(x = discover_yr, y = fire_count, color = mang_level)) +
geom_line() +
labs(title = "CA Wildfires Over Time Across Land Management Level",
x = "Year Discovered",
y = "Number of Fires",
color = "Land Management")
fire_counts_manglvl <- fires_manage %>%
group_by(mang_level) %>%
summarize(fire_count = n()) %>%
mutate(percentage = (fire_count / sum(fire_count)) * 100)
ggplot(fire_counts_manglvl, aes(x = "", y = percentage, fill = mang_level, label = paste0(round(percentage), "%"))) +
geom_bar(stat = "identity", width = 1) +
geom_text(position = position_stack(vjust = 0.5), aes(x = 1.55), color = "black", size = 3) +
coord_polar("y", start = 0) +
labs(title = "Wildfires on Public Lands:",
subtitle = "Jurisdiction of public land fires from 1984-2020",
fill = "") +
theme_void() +
theme(legend.position = "bottom") +
scale_fill_brewer(palette = "Set2")
#74.3% of fires occurred on Federal Land, 510 fires
#17.4% of fires occurred on State Land, 120 fires
#nothing else of real importance
#and this is from 1984 - 2020 ...
fire_counts_manglvlyr <- fires_manage %>%
group_by(mang_level, discover_yr) %>%
summarize(fire_count = n(), total_acres = sum(total_reported_acres)) %>%
ungroup() %>%
group_by(discover_yr) %>%
mutate(total_fires = sum(fire_count),
total_acres_burnt = sum(total_acres),
numfires_perc = paste0(round((fire_count / total_fires) * 100), "%"),
acresfires_perc = paste0(round((total_acres / total_acres_burnt) * 100), "%"),
avg_size = total_acres / fire_count) %>%
ungroup()
ggplot(fire_counts_manglvlyr, aes(x = discover_yr, y = fire_count, color = mang_level)) +
geom_line() +
labs(title = "CA Wildfires Over Time Across Land Management Level",
x = "Year Discovered",
y = "Number of Fires",
color = "Land Management")
fire_counts_manglvl <- fires_manage %>%
group_by(mang_level) %>%
summarize(fire_count = n()) %>%
mutate(percentage = (fire_count / sum(fire_count)) * 100)
ggplot(fire_counts_manglvl, aes(x = "", y = percentage, fill = mang_level, label = paste0(round(percentage), "%"))) +
geom_bar(stat = "identity", width = 1) +
geom_text(position = position_stack(vjust = 0.5), aes(x = 1.55), color = "black", size = 3) +
coord_polar("y", start = 0) +
labs(title = "Wildfires on Public Lands:",
subtitle = "Jurisdiction of public land fires from 1984-2020",
fill = "") +
theme_void() +
theme(legend.position = "bottom") +
scale_fill_brewer(palette = "Set2")
#74.3% of fires occurred on Federal Land, 510 fires
#17.4% of fires occurred on State Land, 120 fires
#nothing else of real importance
#and this is from 1984 - 2020 ...
View(fire_counts_manglvlyr)
ggplot(fire_counts_manglvlyr, aes(x = discover_yr, y = numfires_perc, color = mang_level)) +
geom_line() +
labs(title = "Land Management Jurisdiction of CA Wildfires",
x = "Year Discovered",
y = "Percentage of Total Fires",
color = "Land Management")
fire_counts_manglvlyr$numfires_perc <- factor(fire_counts_manglvlyr$numfires_perc, levels = unique(fire_counts_manglvlyr$numfires_perc))
ggplot(fire_counts_manglvlyr, aes(x = discover_yr, y = numfires_perc, color = mang_level)) +
geom_line() +
labs(title = "Land Management Jurisdiction of CA Wildfires",
x = "Year Discovered",
y = "Percentage of Total Fires",
color = "Land Management")
fire_counts_manglvlyr <- fires_manage %>%
group_by(mang_level, discover_yr) %>%
summarize(fire_count = n(), total_acres = sum(total_reported_acres)) %>%
ungroup() %>%
group_by(discover_yr) %>%
mutate(total_fires = sum(fire_count),
total_acres_burnt = sum(total_acres),
numfires_perc = round((fire_count / total_fires) * 100),
acresfires_perc = round((total_acres / total_acres_burnt) * 100),
avg_size = total_acres / fire_count) %>%
ungroup()
ggplot(fire_counts_manglvlyr, aes(x = discover_yr, y = numfires_perc, color = mang_level)) +
geom_line() +
labs(title = "Land Management Jurisdiction of CA Wildfires",
x = "Year Discovered",
y = "Percentage of Total Fires",
color = "Land Management")
fire_counts_manglvlyr <- fires_manage %>%
group_by(mang_level, discover_yr) %>%
summarize(fire_count = n(), total_acres = sum(total_reported_acres)) %>%
ungroup() %>%
group_by(discover_yr) %>%
mutate(total_fires = sum(fire_count),
total_acres_burnt = sum(total_acres),
numfires_perc = round((fire_count / total_fires) * 100),
acresfires_perc = round((total_acres / total_acres_burnt) * 100),
avg_size = total_acres / fire_count) %>%
ungroup()
fire_counts_manglvlyr$numfires_perc <- factor(fire_counts_manglvlyr$numfires_perc, levels = unique(fire_counts_manglvlyr$numfires_perc))
ggplot(fire_counts_manglvlyr, aes(x = discover_yr, y = fire_count, color = mang_level)) +
geom_line() +
labs(title = "CA Wildfires Over Time Across Land Management Jurisdiction",
x = "Year Discovered",
y = "Number of Fires",
color = "Land Management")
ggplot(fire_counts_manglvlyr, aes(x = discover_yr, y = numfires_perc, color = mang_level)) +
geom_line() +
labs(title = "Land Management Jurisdiction of CA Wildfires: Number of Fires",
x = "Year Discovered",
y = "Percentage of Total Fires",
color = "Land Management")
ggplot(fire_counts_manglvlyr, aes(x = discover_yr, y = acresfires_perc, color = mang_level)) +
geom_line() +
labs(title = "Land Management Jurisdiction of CA Wildfires: Acres Burnt",
x = "Year Discovered",
y = "Percentage of Total Acres Burnt",
color = "Land Management")
fire_counts_manglvlyr <- fires_manage %>%
group_by(mang_level, discover_yr) %>%
summarize(fire_count = n(), total_acres = sum(total_reported_acres)) %>%
ungroup() %>%
group_by(discover_yr) %>%
mutate(total_fires = sum(fire_count),
total_acres_burnt = sum(total_acres),
numfires_perc = round((fire_count / total_fires) * 100),
acresfires_perc = round((total_acres / total_acres_burnt) * 100),
avg_size = total_acres / fire_count) %>%
ungroup()
ggplot(fire_counts_manglvlyr, aes(x = discover_yr, y = fire_count, color = mang_level)) +
geom_line() +
labs(title = "CA Wildfires Over Time Across Land Management Jurisdiction",
x = "Year Discovered",
y = "Number of Fires",
color = "Land Management")
ggplot(fire_counts_manglvlyr, aes(x = discover_yr, y = numfires_perc, color = mang_level)) +
geom_line() +
labs(title = "Land Management Jurisdiction of CA Wildfires: Number of Fires",
x = "Year Discovered",
y = "Percentage of Total Fires",
color = "Land Management")
ggplot(fire_counts_manglvlyr, aes(x = discover_yr, y = acresfires_perc, color = mang_level)) +
geom_line() +
labs(title = "Land Management Jurisdiction of CA Wildfires: Acres Burnt",
x = "Year Discovered",
y = "Percentage of Total Acres Burnt",
color = "Land Management")
ggplot(fire_counts_manglvlyr, aes(x = discover_yr, y = avg_size, color = mang_level)) +
geom_line() +
labs(title = "Land Management Jurisdiction of CA Wildfires: Fire Size",
x = "Year Discovered",
y = "Average Size of Fires",
color = "Land Management")
ggplot(fires_county_grp, aes(x = discover_yr, y = numfires_perc, color = mang_level)) +
geom_line() +
labs(title = "CA Wildfires across Counties: Number of Fires",
x = "Year Discovered",
y = "Percentage of Total Fires",
color = "Land Management")
ggplot(fires_county_grp, aes(x = discover_yr, y = numfires_perc, color = county_name)) +
geom_line() +
labs(title = "CA Wildfires across Counties: Number of Fires",
x = "Year Discovered",
y = "Percentage of Total Fires",
color = "Land Management")
fires_county_grp <- fires_county %>%
group_by(county_name, discover_yr) %>%
summarize(fire_count = n(), total_acres = sum(acres_total)) %>%
ungroup() %>%
group_by(discover_yr) %>%
mutate(total_fires = sum(fire_count),
total_acres_burnt = sum(total_acres),
numfires_perc = round((fire_count / total_fires) * 100),
acresfires_perc = round((total_acres / total_acres_burnt) * 100),
avg_size = total_acres / fire_count) %>%
ungroup()
ggplot(fires_county_grp, aes(x = discover_yr, y = fire_count, color = county_name)) +
geom_line() +
labs(title = "CA Wildfires across Counties: Number of Fires",
x = "Year Discovered",
y = "Number of Fires",
color = "County")
ggplot(fires_county_grp, aes(x = discover_yr, y = numfires_perc, color = county_name)) +
geom_line() +
labs(title = "CA Wildfires across Counties: Percentage of Fires",
x = "Year Discovered",
y = "Percentage of Total Fires",
color = "County")
ggplot(fires_county_grp, aes(x = discover_yr, y = acresfires_perc, color = county_name)) +
geom_line() +
labs(title = "CA Wildfires across Counties: Percentage of Total Fire Damage",
x = "Year Discovered",
y = "Percentage of Total Acres Burnt",
color = "County")
ggplot(fires_county_grp, aes(x = discover_yr, y = avg_size, color = county_name)) +
geom_line() +
labs(title = "CA Wildfires across Counties: Average Size of Fires",
x = "Year Discovered",
y = "Average Size of Fires",
color = "County")
fire_counts_manglvlyr <- fires_manage %>%
group_by(mang_level, discover_yr) %>%
summarize(fire_count = n(), total_acres = sum(total_reported_acres)) %>%
ungroup() %>%
group_by(discover_yr) %>%
mutate(total_fires = sum(fire_count),
total_acres_burnt = sum(total_acres),
numfires_perc = round((fire_count / total_fires) * 100),
acresfires_perc = round((total_acres / total_acres_burnt) * 100),
avg_size = total_acres / fire_count) %>%
ungroup()
ggplot(fire_counts_manglvlyr, aes(x = discover_yr, y = fire_count, color = mang_level)) +
geom_line() +
labs(title = "CA Wildfires Over Time Across Land Management Jurisdiction",
x = "Year Discovered",
y = "Number of Fires",
color = "Land Management")
ggplot(fire_counts_manglvlyr, aes(x = discover_yr, y = numfires_perc, color = mang_level)) +
geom_line() +
labs(title = "Land Management Jurisdiction of CA Wildfires: Number of Fires",
x = "Year Discovered",
y = "Percentage of Total Fires",
color = "Land Management")
ggplot(fire_counts_manglvlyr, aes(x = discover_yr, y = acresfires_perc, color = mang_level)) +
geom_line() +
labs(title = "Land Management Jurisdiction of CA Wildfires: Acres Burnt",
x = "Year Discovered",
y = "Percentage of Total Acres Burnt",
color = "Land Management")
ggplot(fire_counts_manglvlyr, aes(x = discover_yr, y = avg_size, color = mang_level)) +
geom_line() +
labs(title = "Land Management Jurisdiction of CA Wildfires: Fire Size",
x = "Year Discovered",
y = "Average Size of Fires",
color = "Land Management")
fire_counts_manglvlyr <- fires_manage %>%
group_by(mang_level, discover_yr) %>%
summarize(fire_count = n(), total_acres = sum(total_reported_acres)) %>%
ungroup() %>%
group_by(discover_yr) %>%
mutate(total_fires = sum(fire_count),
total_acres_burnt = sum(total_acres),
numfires_perc = round((fire_count / total_fires) * 100),
acresfires_perc = round((total_acres / total_acres_burnt) * 100),
avg_size = total_acres / fire_count) %>%
ungroup()
ggplot(fire_counts_manglvlyr, aes(x = discover_yr, y = fire_count, color = mang_level)) +
geom_line() +
labs(title = "CA Wildfires Over Time Across Land Management Jurisdiction",
x = "Year Discovered",
y = "Number of Fires",
color = "Land Management")
ggplot(fire_counts_manglvlyr, aes(x = discover_yr, y = numfires_perc, color = mang_level)) +
geom_line() +
labs(title = "Land Management Jurisdiction of CA Wildfires: Proportion of Fires",
x = "Year Discovered",
y = "Percentage of Total Fires",
color = "Land Management")
ggplot(fire_counts_manglvlyr, aes(x = discover_yr, y = acresfires_perc, color = mang_level)) +
geom_line() +
labs(title = "Land Management Jurisdiction of CA Wildfires: Proportion of Acres Burnt",
x = "Year Discovered",
y = "Percentage of Total Acres Burnt",
color = "Land Management")
ggplot(fire_counts_manglvlyr, aes(x = discover_yr, y = avg_size, color = mang_level)) +
geom_line() +
labs(title = "Land Management Jurisdiction of CA Wildfires: Fire Size",
x = "Year Discovered",
y = "Average Size of Fires",
color = "Land Management")
ggplot(fire_counts_manglvlyr, aes(x = discover_yr, y = total_acres_burnt, color = mang_level)) +
geom_line() +
labs(title = "Land Management Jurisdiction of CA Wildfires: Acres Burnt",
x = "Year Discovered",
y = "Total Acres Burnt",
color = "Land Management")
View(fire_counts_manglvlyr)
fire_counts_manglvlyr <- fires_manage %>%
group_by(mang_level, discover_yr) %>%
summarize(fire_count = n(), total_acres = sum(total_reported_acres)) %>%
ungroup() %>%
group_by(discover_yr) %>%
mutate(total_fires = sum(fire_count),
total_acres_burnt = sum(total_acres),
numfires_perc = round((fire_count / total_fires) * 100),
acresfires_perc = round((total_acres / total_acres_burnt) * 100),
avg_size = total_acres / fire_count) %>%
ungroup()
ggplot(fire_counts_manglvlyr, aes(x = discover_yr, y = fire_count, color = mang_level)) +
geom_line() +
labs(title = "CA Wildfires Over Time Across Land Management Jurisdiction",
x = "Year Discovered",
y = "Number of Fires",
color = "Land Management")
ggplot(fire_counts_manglvlyr, aes(x = discover_yr, y = numfires_perc, color = mang_level)) +
geom_line() +
labs(title = "Land Management Jurisdiction of CA Wildfires: Proportion of Fires",
x = "Year Discovered",
y = "Percentage of Total Fires",
color = "Land Management")
ggplot(fire_counts_manglvlyr, aes(x = discover_yr, y = total_acres_burnt, color = mang_level)) +
geom_line() +
labs(title = "Land Management Jurisdiction of CA Wildfires: Acres Burnt",
x = "Year Discovered",
y = "Total Acres Burnt",
color = "Land Management")
ggplot(fire_counts_manglvlyr, aes(x = discover_yr, y = avg_size, color = mang_level)) +
geom_line() +
labs(title = "Land Management Jurisdiction of CA Wildfires: Fire Size",
x = "Year Discovered",
y = "Average Size of Fires",
color = "Land Management")
