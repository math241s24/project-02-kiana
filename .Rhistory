select(NAME, geometry)
# Merge fires_county_grp with ca_county_wkts to get county perimeters
county_fire_stats <- fires_county_grp %>%
st_as_sf() %>%
st_join(ca_county_wkts, by = c("county_name" = "NAME")) %>%
mutate(WKT = ifelse(!is.na(geometry), geometry, WKT)) %>%
select(-geometry)
ca_county_wkts <- ca_sf %>%
select(NAME, geometry)
# Merge fires_county_grp with ca_county_wkts to get county perimeters
county_fire_stats <- st_join(fires_county_grp, ca_county_wkts, by = c("county_name" = "NAME")) %>%
mutate(WKT = ifelse(!is.na(geometry), geometry, WKT)) %>%
select(-geometry)
ca_county_wkts <- ca_sf %>%
select(NAME, geometry)
# Find the corresponding county perimeter for each fire
fires_county_grp <- fires_county_grp %>%
mutate(WKT = case_when(
county_name == ca_county_wkts$NAME ~ ca_county_wkts$geometry,
TRUE ~ WKT
))
fires_county_grp <- fires_county %>%
group_by(county_name, discover_yr) %>%
summarize(fire_count = n(), total_acres = sum(acres_total)) %>%
ungroup() %>%
group_by(discover_yr) %>%
mutate(total_fires = sum(fire_count),
total_acres_burnt = sum(total_acres),
numfires_perc = round((fire_count / total_fires) * 100),
acresfires_perc = round((total_acres / total_acres_burnt) * 100),
avg_size = total_acres / fire_count) %>%
ungroup()
fires_sf <- readRDS('Data/fires_sf.rds')
ca_sf <- readRDS('Data/ca_sf.rds')
fires_manage <- readRDS('Data/fires_manage.rds')
fires_county <- readRDS('Data/fires_county.rds')
fires_sf$discover_yr <- factor(fires_sf$discover_yr)
#animated plot of wildfires each year with county boundaries
fires_county_grp <- fires_county %>%
group_by(county_name, discover_yr) %>%
summarize(fire_count = n(), total_acres = sum(acres_total)) %>%
ungroup() %>%
group_by(discover_yr) %>%
mutate(total_fires = sum(fire_count),
total_acres_burnt = sum(total_acres),
numfires_perc = round((fire_count / total_fires) * 100),
acresfires_perc = round((total_acres / total_acres_burnt) * 100),
avg_size = total_acres / fire_count) %>%
ungroup()
View(ca_county_wkts)
ca_county_wkts <- ca_sf %>%
select(NAME, geometry)
# Find the corresponding county perimeter for each fire
fires_county_grp <- fires_county_grp %>%
mutate(WKT = case_when(
county_name == ca_county_wkts$NAME ~ ca_county_wkts$geometry,
TRUE ~ WKT
))
fires_sf <- readRDS('Data/fires_sf.rds')
ca_sf <- readRDS('Data/ca_sf.rds')
fires_manage <- readRDS('Data/fires_manage.rds')
fires_county <- readRDS('Data/fires_county.rds')
fires_county_grp <- fires_county %>%
group_by(county_name, discover_yr) %>%
summarize(fire_count = n(), total_acres = sum(acres_total)) %>%
ungroup() %>%
group_by(discover_yr) %>%
mutate(total_fires = sum(fire_count),
total_acres_burnt = sum(total_acres),
numfires_perc = round((fire_count / total_fires) * 100),
acresfires_perc = round((total_acres / total_acres_burnt) * 100),
avg_size = total_acres / fire_count) %>%
ungroup()
fires_county_grp <- fires_county %>%
group_by(county_name, discover_yr) %>%
summarize(fire_count = n(), total_acres = sum(acres_total)) %>%
ungroup() %>%
group_by(discover_yr) %>%
mutate(total_fires = sum(fire_count),
total_acres_burnt = sum(total_acres),
numfires_perc = round((fire_count / total_fires) * 100),
acresfires_perc = round((total_acres / total_acres_burnt) * 100),
avg_size = total_acres / fire_count) %>%
ungroup()
fires_sf <- readRDS('Data/fires_sf.rds')
ca_sf <- readRDS('Data/ca_sf.rds')
fires_manage <- readRDS('Data/fires_manage.rds')
fires_county <- readRDS('Data/fires_county.rds')
fires_county_grp <- fires_county %>%
group_by(county_name, discover_yr) %>%
summarize(fire_count = n(), total_acres = sum(acres_total)) %>%
ungroup() %>%
group_by(discover_yr) %>%
mutate(total_fires = sum(fire_count),
total_acres_burnt = sum(total_acres),
numfires_perc = round((fire_count / total_fires) * 100),
acresfires_perc = round((total_acres / total_acres_burnt) * 100),
avg_size = total_acres / fire_count) %>%
ungroup()
fires_county_grp <- fires_county %>%
group_by(county_name, discover_yr) %>%
summarize(fire_count = n(), total_acres = sum(acres_total)) %>%
ungroup() %>%
group_by(discover_yr) %>%
mutate(total_fires = sum(fire_count),
total_acres_burnt = sum(total_acres),
numfires_perc = round((fire_count / total_fires) * 100),
acresfires_perc = round((total_acres / total_acres_burnt) * 100),
avg_size = total_acres / fire_count) %>%
ungroup()
county_fire_stats <- fires_county_grp
# Select relevant columns from ca_sf
ca_county_wkts <- ca_sf %>%
select(NAME, geometry)
# Iterate over each row in county_fire_stats and update the WKT column
county_fire_stats$WKT <- sapply(seq_len(nrow(county_fire_stats)), function(i) {
county_name <- county_fire_stats$county_name[i]
match_geom <- ca_county_wkts$geometry[ca_county_wkts$NAME == county_name]
if (length(match_geom) > 0) {
match_geom
} else {
county_fire_stats$WKT[i]
}
})
View(fires_county_grp)
View(fires_county_sf)
library(readr)
library(tidyverse)
library(tidycensus)
library(flextable)
library(sf)
library(tigris)
library(tmap)
library(RColorBrewer)
library(countdown)
library(gt)
library(readxl)
library(gganimate)
library(gifski)
library(knitr)
library(kableExtra)
library(transformr)
fires_sf <- readRDS('Data/fires_sf.rds')
ca_sf <- readRDS('Data/ca_sf.rds')
fires_manage <- readRDS('Data/fires_manage.rds')
fires_county <- readRDS('Data/fires_county.rds')
fires_county_grp <- fires_county %>%
group_by(county_name, discover_yr) %>%
summarize(fire_count = n(), total_acres = sum(acres_total)) %>%
ungroup() %>%
group_by(discover_yr) %>%
mutate(total_fires = sum(fire_count),
total_acres_burnt = sum(total_acres),
numfires_perc = round((fire_count / total_fires) * 100),
acresfires_perc = round((total_acres / total_acres_burnt) * 100),
avg_size = total_acres / fire_count) %>%
ungroup()
county_fire_stats <- fires_county_grp
# Select relevant columns from ca_sf
ca_county_wkts <- ca_sf %>%
select(NAME, geometry)
# Iterate over each row in county_fire_stats and update the WKT column
county_fire_stats$WKT <- sapply(seq_len(nrow(county_fire_stats)), function(i) {
county_name <- county_fire_stats$county_name[i]
match_geom <- ca_county_wkts$geometry[ca_county_wkts$NAME == county_name]
if (length(match_geom) > 0) {
match_geom
} else {
county_fire_stats$WKT[i]
}
})
View(fires_county_grp)
View(county_fire_stats)
View(county_fire_stats)
library(readr)
library(tidyverse)
library(tidycensus)
library(flextable)
library(sf)
library(tigris)
library(tmap)
library(RColorBrewer)
library(countdown)
library(gt)
library(readxl)
library(gganimate)
library(gifski)
library(knitr)
library(kableExtra)
library(transformr)
fires_sf <- readRDS('Data/fires_sf.rds')
ca_sf <- readRDS('Data/ca_sf.rds')
fires_manage <- readRDS('Data/fires_manage.rds')
fires_county <- readRDS('Data/fires_county.rds')
fires_county_grp <- fires_county %>%
group_by(county_name, discover_yr) %>%
summarize(fire_count = n(), total_acres = sum(acres_total)) %>%
ungroup() %>%
group_by(discover_yr) %>%
mutate(total_fires = sum(fire_count),
total_acres_burnt = sum(total_acres),
numfires_perc = round((fire_count / total_fires) * 100),
acresfires_perc = round((total_acres / total_acres_burnt) * 100),
avg_size = total_acres / fire_count) %>%
ungroup()
View(fires_county_grp)
county_fire_stats <- fires_county_grp
View(fires_county_grp)
View(county_fire_stats)
ca_county_wkts <- ca_sf %>%
select(NAME, geometry)
View(ca_county_wkts)
for (i in seq_len(nrow(county_fire_stats))) {
county_name <- county_fire_stats$county_name[i]
match_geom <- ca_county_wkts$geometry[ca_county_wkts$NAME == county_name]
if (length(match_geom) > 0) {
county_fire_stats$WKT[i] <- match_geom
}
}
View(county_fire_stats)
saveRDS(fires_county_grp, "fires_county_grp.rds")
saveRDS(county_fire_stats, "county_fire_stats.rds")
library(readr)
library(tidyverse)
library(tidycensus)
library(flextable)
library(sf)
library(tigris)
library(tmap)
library(RColorBrewer)
library(countdown)
library(gt)
library(readxl)
library(gganimate)
library(gifski)
library(knitr)
library(kableExtra)
library(transformr)
fires_sf <- readRDS('Data/fires_sf.rds')
ca_sf <- readRDS('Data/ca_sf.rds')
fires_manage <- readRDS('Data/fires_manage.rds')
fires_county <- readRDS('Data/fires_county.rds')
fires_county_grp <- readRDS('Data/fires_county_grp.rds')
county_fire_stats <- readRDS('Data/county_fire_stats.rds')
View(fires_county_grp)
View(fires_county)
View(county_fire_stats)
ggplot() +
geom_sf(data = county_fire_stats, aes(fill = total_fires), show.legend = FALSE) +
labs(title = 'Year: {closest_state}') +
theme_void() +
transition_states(discover_yr,
transition_length = 10,
state_length = 10)
ggplot() +
geom_sf(data = ca_sf, aes(), fill = NA, color = "black", size = 1.2) +
geom_sf(data = county_fire_stats, aes(fill = numfires_perc), show.legend = FALSE) +
labs(title = 'Year: {closest_state}') +
theme_void() +
transition_states(discover_yr,
transition_length = 10,
state_length = 10)
ggplot() +
geom_sf(data = ca_sf, aes(), fill = NA, color = "black", size = 1.2) +
geom_sf(data = county_fire_stats, aes(fill = numfires_perc), show.legend = FALSE) +
labs(title = 'Year: {closest_state}') +
theme_void() +
scale_fill_viridis_c(option = "magma", begin = 0.2, end = 0.8, name = "Percentage of Fires") +
transition_states(discover_yr,
transition_length = 10,
state_length = 10)
ggplot() +
geom_sf(data = ca_sf, aes(), fill = NA, color = "black", size = 1.2) +
geom_sf(data = county_fire_stats, aes(fill = total_fires), show.legend = FALSE) +
labs(title = 'Year: {closest_state}') +
theme_void() +
scale_fill_viridis_c(option = "magma", begin = 0.2, end = 0.8, name = "Percentage of Fires") +
transition_states(discover_yr,
transition_length = 10,
state_length = 10)
ggplot() +
geom_sf(data = ca_sf, aes(), fill = NA, color = "black", size = 1.2) +
geom_sf(data = county_fire_stats, aes(fill = total_fires), show.legend = FALSE) +
labs(title = 'Year: {closest_state}') +
theme_void() +
scale_fill_viridis(option = "H", begin = 0.2, end = 0.8, name = "Percentage of Fires") +
transition_states(discover_yr,
transition_length = 10,
state_length = 10)
ggplot() +
geom_sf(data = ca_sf, aes(), fill = NA, color = "black", size = 1.2) +
geom_sf(data = county_fire_stats, aes(fill = total_fires), show.legend = FALSE) +
labs(title = 'Year: {closest_state}') +
theme_void() +
transition_states(discover_yr,
transition_length = 10,
state_length = 10)
library(ggtext)
install.packages("ggtext")
library(ggtext)
ggplot() +
geom_sf(data = ca_sf, aes(), fill = NA, color = "black", size = 1.2) +
geom_sf(data = county_fire_stats, aes(fill = numfires_perc), show.legend = FALSE) +
geom_sf_label(data = county_fire_stats, aes(label = paste("Num Fires:", numfires_perc)), size = 3, color = "black", label.padding = unit(0.25, "lines")) +
labs(title = 'Year: {closest_state}') +
theme_void() +
scale_fill_viridis_c(option = "magma", begin = 0.2, end = 0.8, name = "Percentage of Fires") +
transition_states(discover_yr,
transition_length = 10,
state_length = 10)
ggplot() +
geom_sf(data = ca_sf, aes(), fill = NA, color = "black", size = 1.2) +
geom_sf(data = county_fire_stats, aes(fill = numfires_perc), show.legend = FALSE) +
labs(title = 'Year: {closest_state}') +
theme_void() +
scale_fill_viridis_c(option = "magma", begin = 0.2, end = 0.8, name = "Percentage of Fires") +
transition_states(discover_yr,
transition_length = 10,
state_length = 10)
ggplot() +
geom_sf(data = ca_sf, aes(), fill = NA, color = "black", size = 1.2) +
geom_sf(data = county_fire_stats, aes(fill = avg_size), show.legend = FALSE) +
labs(title = 'Year: {closest_state}') +
theme_void() +
scale_fill_viridis_c(option = "magma", begin = 0.2, end = 0.8, name = "Percentage of Fires") +
transition_states(discover_yr,
transition_length = 10,
state_length = 10)
ggplot() +
geom_sf(data = ca_sf, aes(), fill = NA, color = "black", size = 1.2) +
geom_sf(data = county_fire_stats, aes(fill = avg_size), show.legend = FALSE) +
labs(title = 'Year: {closest_state}') +
theme_void() +
scale_colour_brewer(palette = "YlOrRd") +
transition_states(discover_yr,
transition_length = 10,
state_length = 10)
ggplot() +
geom_sf(data = ca_sf, aes(), fill = NA, color = "black", size = 1.2) +
geom_sf(data = county_fire_stats, aes(fill = avg_size), show.legend = "fill") +
labs(title = 'Year: {closest_state}') +
theme_void() +
scale_fill_viridis_c(option = "magma", begin = 0.2, end = 0.8, name = "Average Size") +
transition_states(discover_yr,
transition_length = 10,
state_length = 10)
ggplot() +
geom_sf(data = ca_sf, aes(), fill = NA, color = "black", size = 1.2) +
geom_sf(data = county_fire_stats, aes(fill = avg_size), show.legend = "fill") +
labs(title = "Average Size of Fires (total acres burnt / number of fires",
subtitle = 'Year: {closest_state}') +
theme_void() +
scale_fill_viridis_c(option = "magma", begin = 0.2, end = 0.8, name = "Average Size") +
transition_states(discover_yr,
transition_length = 10,
state_length = 10)
ggplot() +
geom_sf(data = ca_sf, aes(), fill = NA, color = "black", size = 1.2) +
geom_sf(data = county_fire_stats, aes(fill = avg_size), show.legend = "fill") +
labs(title = "Average Size of Fires (Acres Burnt/Number of Fires",
subtitle = 'Year: {closest_state}') +
theme_void() +
scale_fill_gradient(low = "yellow",
high = "red",
na.value = "white",
limits = c(0, max(county_fire_stats$avg_size)),
breaks = c(0, 0.5*max(county_fire_stats$avg_size),
max(county_fire_stats$avg_size)),
labels = c("0", "Medium", "High")) +
transition_states(discover_yr,
transition_length = 10,
state_length = 10)
ggplot() +
geom_sf(data = ca_sf, aes(), fill = NA, color = "black", size = 1.2) +
geom_sf(data = county_fire_stats, aes(fill = avg_size), show.legend = "fill") +
labs(title = "Fire Intensity by County",
subtitle = 'Year: {closest_state}',
fill = "Intensity (Acres Burnt/Number of Fires)") +
theme_void() +
scale_fill_gradient(low = "yellow", high = "red") +
transition_states(discover_yr,
transition_length = 10,
state_length = 10)
ggplot() +
geom_sf(data = ca_sf, aes(), fill = NA, color = "black", size = 1.2) +
geom_sf(data = county_fire_stats, aes(fill = avg_size), show.legend = "fill") +
labs(title = "Fire Intensity by County",
subtitle = 'Year: {closest_state}',
fill = "Acres Burnt/Number of Fires") +
theme_void() +
scale_fill_gradient(low = "#ffdc6b", high = "#ad2723") +
transition_states(discover_yr,
transition_length = 10,
state_length = 10)
ggplot() +
geom_sf(data = ca_sf, aes(), fill = NA, color = "black", size = 1.2) +
geom_sf(data = county_fire_stats, aes(fill = total_acres), show.legend = "fill") +
labs(title = "Total Acres Burnt",
subtitle = 'Year: {closest_state}',
fill = "Acres Burnt") +
theme_void() +
scale_fill_gradient(low = "#ffdc6b", high = "#ad2723") +
transition_states(discover_yr,
transition_length = 10,
state_length = 10)
ggplot() +
geom_sf(data = ca_sf, aes(), fill = NA, color = "black", size = 1.2) +
geom_sf(data = county_fire_stats, aes(fill = fire_count), show.legend = "fill") +
labs(title = "Wildfire Frequency",
subtitle = 'Year: {closest_state}',
fill = "Number of Wildfires") +
theme_void() +
scale_fill_gradient(low = "#ffdc6b", high = "#ad2723") +
transition_states(discover_yr,
transition_length = 10,
state_length = 10)
ggplot() +
geom_sf(data = ca_sf, aes(), fill = NA, color = "black", size = 1.2) +
geom_sf(data = county_fire_stats, aes(fill = numfires_perc), show.legend = "fill") +
labs(title = "Wildfire Frequency",
subtitle = 'Year: {closest_state}',
fill = "Percentage of Yearly Wildfires") +
theme_void() +
scale_fill_gradient(low = "#ffdc6b", high = "#ad2723") +
transition_states(discover_yr,
transition_length = 10,
state_length = 10)
anim_totfires_county <- ggplot() +
geom_sf(data = ca_sf, aes(), fill = NA, color = "black", size = 1.2) +
geom_sf(data = county_fire_stats, aes(fill = fire_count), show.legend = "fill") +
labs(title = "Wildfire Frequency",
subtitle = 'Year: {closest_state}',
fill = "Number of Wildfires") +
theme_void() +
scale_fill_gradient(low = "#ffdc6b", high = "#ad2723") +
transition_states(discover_yr,
transition_length = 10,
state_length = 10)
anim_save("anim_totfires_county.gif", anim_totfires_county, renderer = gifski_renderer())
anim_totacres_county <- ggplot() +
geom_sf(data = ca_sf, aes(), fill = NA, color = "black", size = 1.2) +
geom_sf(data = county_fire_stats, aes(fill = total_acres), show.legend = "fill") +
labs(title = "Total Acres Burnt",
subtitle = 'Year: {closest_state}',
fill = "Acres Burnt") +
theme_void() +
scale_fill_gradient(low = "#ffdc6b", high = "#ad2723") +
transition_states(discover_yr,
transition_length = 10,
state_length = 10)
anim_save("anim_totacres_county.gif", anim_totacres_county, renderer = gifski_renderer())
anim_avgsize_county <- ggplot() +
geom_sf(data = ca_sf, aes(), fill = NA, color = "black", size = 1.2) +
geom_sf(data = county_fire_stats, aes(fill = avg_size), show.legend = "fill") +
labs(title = "Fire Intensity by County",
subtitle = 'Year: {closest_state}',
fill = "Acres Burnt/Number of Fires") +
theme_void() +
scale_fill_gradient(low = "#ffdc6b", high = "#ad2723") +
transition_states(discover_yr,
transition_length = 10,
state_length = 10)
anim_save("anim_avgsize_county.gif", anim_avgsize_county, renderer = gifski_renderer())
ggplot() +
geom_sf(data = ca_sf, aes(), fill = NA, color = "black", size = 1.2) +
geom_sf(data = county_fire_stats, aes(fill = county_name), show.legend = FALSE) +
labs(title = 'Year: {closest_state}') +
theme_void() +
transition_states(discover_yr,
transition_length = 10,
state_length = 10)
anim_firescounties_grp <- ggplot() +
geom_sf(data = ca_sf, aes(), fill = NA, color = "black", size = 1.2) +
geom_sf(data = county_fire_stats, aes(fill = county_name), show.legend = FALSE) +
labs(title = 'Year: {closest_state}') +
theme_void() +
transition_states(discover_yr,
transition_length = 10,
state_length = 10)
anim_save("anim_firescounties_grp.gif", anim_firescounties_grp, renderer = gifski_renderer())
#animated plot of wildfires each year with county boundaries
anim_firescounties <- ggplot() +
geom_sf(data = ca_sf, aes(), fill = NA, color = "black", size = 1.2) +
geom_sf(data = fires_county_grp, aes(fill = county_name), show.legend = FALSE) +
labs(title = "Wildfire Perimeters",
subtitle = 'Year: {closest_state}') +
theme_void() +
transition_states(discover_yr,
transition_length = 10,
state_length = 10)
anim_save("anim_firescounties.gif", anim_firescounties, renderer = gifski_renderer())
#animated plot of counties with wildfires
anim_firescounties_grp <- ggplot() +
geom_sf(data = ca_sf, aes(), fill = NA, color = "black", size = 1.2) +
geom_sf(data = county_fire_stats, aes(fill = county_name), show.legend = FALSE) +
labs(title = "Counties Experiencing Wildfires",
subtitle = 'Year: {closest_state}') +
theme_void() +
transition_states(discover_yr,
transition_length = 10,
state_length = 10)
anim_save("anim_firescounties_grp.gif", anim_firescounties_grp, renderer = gifski_renderer())
anim_firescounties <- ggplot() +
geom_sf(data = ca_sf, aes(), fill = NA, color = "black", size = 1.2) +
geom_sf(data = fires_county_grp, aes(fill = county_name), show.legend = FALSE) +
labs(title = "Wildfire Perimeters",
subtitle = 'Year: {closest_state}') +
theme_void() +
transition_states(discover_yr,
transition_length = 10,
state_length = 10)
anim_save("anim_firescounties.gif", anim_firescounties, renderer = gifski_renderer())
